//= depend_on_asset "root/root.html"
"use strict";
angular
  .module('sampler.root', [
    'ui.router'
  ])
  .config(function($stateProvider) {
    [
      {
        name: "root",
        abstract: true,
        url: "",
        templateUrl: "<%= asset_path('root/root.html') %>",
        controller: 'Root'
      }
    ].forEach(function(state) {
      $stateProvider.state(state);
    });
  })
  .controller(
    'Root',
    function($scope, Authentication) {
      console.log("setup root");
      $scope.user = null;
      $scope.views = [
        {
          state: 'root.login',
          root: 'root.login',
          title: 'Login'
        },
        {
          state: 'root.hello',
          root: 'root.hello',
          title: 'Hello'
        },
        {
          state: 'root.task.index',
          root: 'root.task',
          title: 'Tasks'
        },
        {
          state: 'root.upload',
          root: 'root.upload',
          title: 'Upload'
        },
        {
          state: 'root.about',
          root: 'root.about',
          title: 'About'
        }
      ];

      $scope.$watch(
        function() { return Authentication.getUser(); },
        function() {
          $scope.user = Authentication.getUser();
          console.log("changed: " + $scope.user);
        });
    });

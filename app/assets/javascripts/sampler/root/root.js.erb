//= depend_on_asset "root/root.html"
//= depend_on_asset "root/current_user.html"
"use strict";
angular
  .module('sampler.root', [
    'ui.router'
  ])
  .config(function($stateProvider) {
    $stateProvider
      .state("root", {
        abstract: true,
        url: "",
        views: {
          '': {
            templateUrl: "<%= asset_path('root/root.html') %>"
          },
          'current_user@': {
            templateUrl: "<%= asset_path('root/current_user.html') %>",
            controller: function($scope, AuthenticationService) {
              console.log("setup root");
              $scope.user = null;
              $scope.$watch(
                function() { return AuthenticationService.getUser(); },
                function() {
                  $scope.user = AuthenticationService.getUser();
                  console.log("changed: " + $scope.user);
                });
            }
          }
        }
      });
  });

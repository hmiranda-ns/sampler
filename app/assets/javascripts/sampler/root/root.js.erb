//= depend_on_asset "root/root.html"
//= depend_on_asset "root/current_user.html"
"use strict";
angular
  .module('sampler.root', [
    'ui.router'
  ])
  .config(function($stateProvider) {
    [
      {
        name: "root",
        abstract: true,
        url: "",
        views: {
          '': {
            templateUrl: "<%= asset_path('root/root.html') %>"
          },
          'current_user@': {
            templateUrl: "<%= asset_path('root/current_user.html') %>",
            controller: 'CurrentUser'
          }
        }
      }
    ].forEach(function(state) {
      $stateProvider.state(state);
    });
  })
  .controller(
    'CurrentUser',
    function($scope, Authentication) {
      console.log("setup root");
      $scope.user = null;
      $scope.$watch(
        function() { return Authentication.getUser(); },
        function() {
          $scope.user = Authentication.getUser();
          console.log("changed: " + $scope.user);
        });
    });
